-- ***************************** SqlDBM: Snowflake ****************************
-- * Generated by SqlDBM: MART SCHEMA, v18 by lesya.rylova+standard@gmail.com *


-- ************************************** DISPOSAL_TRIP_TYPE
CREATE VIEW DISPOSAL_TRIP_TYPE as (SELECT 
  "PKEY", 
  "UNIQUEID", 
  "NAME", 
  "INACTIVE", 
  "SERVICECONFEVENT", 
  "SEQNR", 
  "AUDIT_CREATE_UID", 
  "AUDIT_CREATE_DT", 
  "AUDIT_UPDATED_DT", 
  "EQUIVALENTHAUL", 
  "RO_DISPOSAL_REQUIRED", 
  "RO_DISPOSAL_ONLY", 
  "DISPOSAL_NO_VALIDATION", 
  "DISPOSAL_DO_NOT_SEND", 
  "RO_RETURN_REQUIRED", 
  "RO_TRP_AUTO_CHANGE_REQUIRED", 
  "RO_RETURN_NO_SERVICE_DISABLED", 
  "NON_RO_DISPOSAL_LOADTYPE", 
  "NON_RO_DISPOSAL_ONLY", 
  "MODIFIEDBY", 
  "STAMP", 
  "SESSIONID", 
  "AUDIT_ID", 
  "AUDIT_LOAD_DTM", 
  "DISPOSAL_TRIP_TYPE_CD", 
  "DISPOSAL_TRIP_TYPE_NM" 
FROM (SELECT *,
CASE WHEN UNIQUEID IN ( 'E/R', 'ER' ,'BRN')
     THEN 'ER'
     WHEN UNIQUEID IN ( 'S/O', 'DNR','FYS','FYN','FFY','LIV','FDR','FRN')
     THEN 'EFO'
     WHEN UNIQUEID IN ( 'DEL', 'REL','BTS','BTN','BTY','DNE','TRP','EDE','ERE','ZAD','ZRP')
     THEN 'ND'
     ELSE 'EFO' END AS  DISPOSAL_TRIP_TYPE_CD,
CASE WHEN UNIQUEID IN ( 'E/R', 'ER' ,'BRN')
     THEN 'Empty & Return'
     WHEN UNIQUEID IN ( 'S/O', 'DNR','FYS','FYN','FFY','LIV','FDR','FRN')
     THEN 'Empty and Follow-On'
     WHEN UNIQUEID IN ( 'DEL', 'REL','BTS','BTN','BTY','DNE','TRP','EDE','ERE','ZAD','ZRP')
     THEN 'No Disposal Trip'
ELSE 'Empty and Follow-On' END  AS  DISPOSAL_TRIP_TYPE_NM
FROM
DEV_OCS.ODS.TP_TICKETLOADTYPE
) AS "v_0000017686_0000177637");
