-- ***************************** SqlDBM: Snowflake ****************************
-- * Generated by SqlDBM: MART SCHEMA, v18 by lesya.rylova+standard@gmail.com *


-- ************************************** SUBLOB_DISPOSAL_HRS
CREATE VIEW SUBLOB_DISPOSAL_HRS AS
SELECT
    HAULING_SITE
    ,SUBLOB
    ,SUM(TOTAL_HRS) AS RAW_STEM_DISPOSAL_RETURN_HRS,
    CASE WHEN RAW_STEM_DISPOSAL_RETURN_HRS < 0 THEN 0
    ELSE RAW_STEM_DISPOSAL_RETURN_HRS
    END AS STEM_DISPOSAL_RETURN_HRS
FROM ROUTE_STEM_DISPOSAL_RETURN_HRS
WHERE EVENT_START >= $start_date AND EVENT_END <= $end_date
GROUP BY HAULING_SITE, SUBLOB;
