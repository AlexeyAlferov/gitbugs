-- ***************************** SqlDBM: Snowflake ****************************
-- * Generated by SqlDBM: MART SCHEMA, v18 by lesya.rylova+standard@gmail.com *


-- ************************************** SUB_LOB_HRS
CREATE VIEW SUB_LOB_HRS AS
SELECT
    r.HAULING_SITE
    ,r.SUBLOB
    ,r.TOTAL_ROUTE_DURATION_HRS
    ,sdr.TOTAL_STEM_DISPOSAL_RETURN_HRS
    ,(r.TOTAL_ROUTE_DURATION_HRS - sdr.TOTAL_STEM_DISPOSAL_RETURN_HRS) AS TOTAL_COLLECTION_HRS
FROM SUB_LOB_TOTAL_ROUTE_DURATION r
LEFT JOIN SUB_LOB_STEM_DISPOSAL_RETURN_HRS sdr 
    ON r.HAULING_SITE=sdr.HAULING_SITE AND r.SUBLOB=sdr.SUBLOB;
