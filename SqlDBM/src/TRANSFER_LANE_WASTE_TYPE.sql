-- ***************************** SqlDBM: Snowflake ****************************
-- * Generated by SqlDBM: MART SCHEMA, v18 by lesya.rylova+standard@gmail.com *


-- ************************************** TRANSFER_LANE_WASTE_TYPE
CREATE VIEW TRANSFER_LANE_WASTE_TYPE as
select
coalesce( t1.LANE_ORIGIN_FAC_ID, t2.LANE_ORIGIN_FAC_ID) as LANE_ORIGIN_FAC_ID,
coalesce( t1.WASTE_TYPE, t2.WASTE_TYPE) as WASTE_TYPE,
coalesce( t1.LANE_DESTINATION_FAC_ID, t2.LANE_DESTINATION_FAC_ID) as LANE_DESTINATION_FAC_ID,
coalesce(t1.LANE_NAME, t2.LANE_NAME) as LANE_NAME,
--BMT data as preference
CASE WHEN t1.LANE_ORIGIN_FAC_ID is not null then t1.LONG_HAUL_COST_PER_TON else t2.LONG_HAUL_COST end AS LONG_HAUL_COST_PER_TON,
LONG_HAUL_COST_PER_LOAD ,
--BMT data as preference
CASE WHEN t1.LANE_ORIGIN_FAC_ID is not null then t1.AVERAGE_LOAD_SIZE_TONS else t2.AVERAGE_LOAD_SIZE_TONS end as AVERAGE_LOAD_SIZE_TONS,
case when t1.STATUS_IND is null then 'A' else t1.STATUS_IND end as STATUS_IND ,
case when t1.LANE_ORIGIN_FAC_ID is not null then t1.SOURCE else 'MART' end as SOURCE,
LAST_UPDATED_DTM ,
LAST_UPDATED_USER ,
DATA_COLLCTION_ADD_DELETE_UPDATE ,
MIN_TONS,
MAX_TONS,
volume_constraint_type,
volume_time_unit
from BMT_TRANSFER_LANE_WASTE_TYPE t1 full outer join CORP_TRANSFER_LANE_WASTE_TYPE t2
on  t1.LANE_ORIGIN_FAC_ID = t2.LANE_ORIGIN_FAC_ID and t1.WASTE_TYPE = T2.waste_type and
t1.LANE_DESTINATION_FAC_ID = t2.LANE_DESTINATION_FAC_ID
where nvl(DATA_COLLCTION_ADD_DELETE_UPDATE,'A') != 'D';
