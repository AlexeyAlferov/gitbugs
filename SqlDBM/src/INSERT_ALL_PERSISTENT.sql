-- ***************************** SqlDBM: Snowflake ****************************
-- * Generated by SqlDBM: MART SCHEMA, v18 by lesya.rylova+standard@gmail.com *


-- ************************************** INSERT_ALL_PERSISTENT
CREATE PROCEDURE INSERT_ALL_PERSISTENT(ENO_ID VARCHAR)
RETURNS VARCHAR(16777216)
LANGUAGE JAVASCRIPT
EXECUTE AS OWNER
AS '
var sql_command = "SELECT " + "''" + ENO_ID + "''";
var res = snowflake.execute( {sqlText: sql_command } );
res.next();
var temp_tables = [
	"MODEL_ALL_CONSTRAINTS",
	"MODEL_COLLECTION_POINTS",
	"MODEL_FACILITIES",
	"MODEL_FACILITIES_MATERIAL",
	"MODEL_DEPOT_LOB",
	"MODEL_DISPOSAL_LOB",
	"MODEL_TRANSFER_COSTS",
	"model_hrs_cap",
	"MODEL_SWAP_HEADER",
	"MODEL_SWAP_DETAIL",
	"MODEL_FLOW_CONTROL_RULES",
	"MODEL_FLOW_CONTROL_COLLECTION",
	"EXPLODED_FLOW_CONTROL",
	"MODEL_FLOW_CONTROL_DISPOSAL",
	"MODEL_FLOW_CONTROL_SPECIAL_RATE"

];
for (i = 0; i < temp_tables.length; i++) {
  var sql_command = "INSERT INTO " + temp_tables[i] +"_PERSISTENT SELECT " + "''" + ENO_ID + "'' as ENO_ID, * FROM " + temp_tables[i] +";";
  var res = snowflake.execute( {sqlText: sql_command } );
}
return 1;
';
