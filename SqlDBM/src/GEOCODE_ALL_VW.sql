-- ***************************** SqlDBM: Snowflake ****************************
-- * Generated by SqlDBM: MART SCHEMA, v18 by lesya.rylova+standard@gmail.com *


-- ************************************** GEOCODE_ALL_VW
CREATE VIEW GEOCODE_ALL_VW AS   
 WITH ALL_LAT_LONG AS
(SELECT distinct
    truncate(LATITUDE,6) as LATITUDE,                          
    truncate(LONGITUDE,6) as LONGITUDE
FROM MART.CORP_COMRES_FACT WHERE DEPOTFACID in (Select FAC_ID from HAULING_SITE where MARKET_AREA_CD='K00113' and 
                                                MARKET_AREA_NM = 'WM of New England')
UNION
SELECT distinct
   truncate(LATITUDE,6) as LATITUDE,                          
   truncate(LONGITUDE,6) as LONGITUDE
FROM MART.CORP_ROLLOFF_FACT WHERE DEPOTFACID in (Select FAC_ID from HAULING_SITE where MARKET_AREA_CD='K00113' and 
                                                MARKET_AREA_NM = 'WM of New England')
 )
 select row_number() over(order by LATITUDE,LONGITUDE) IDENTIFIER,
  LATITUDE,                          
  LONGITUDE
    from ALL_LAT_LONG;
