-- ***************************** SqlDBM: Snowflake ****************************
-- * Generated by SqlDBM: MART SCHEMA, v18 by lesya.rylova+standard@gmail.com *


-- ************************************** RO_LOB_HIERARCHY
CREATE VIEW RO_LOB_HIERARCHY as (SELECT 
  "LOB", 
  "SUBLOB", 
  "SUBLOB_DESC", 
  "ESSBASE_SUBLOB_KEY", 
  "ESSBASE_SUBLOB_DESC" 
FROM (select t2.NAME as LOB
,t1.UNIQUEID as SUBLOB
,t1.NAME as SUBLOB_DESC
,CASE WHEN t1.UNIQUEID = 'RO' THEN 260
        WHEN t1.UNIQUEID = 'ROOR' THEN 275
        WHEN t1.UNIQUEID = 'RORY' THEN 270
        WHEN t1.UNIQUEID = 'ROES' THEN 265
END AS ESSBASE_SUBLOB_KEY
,CASE WHEN t1.UNIQUEID = 'RO' THEN 'Roll Off'
        WHEN t1.UNIQUEID = 'ROOR' THEN 'Roll Off Organics'
        WHEN t1.UNIQUEID = 'RORY' THEN 'Roll Off Recycling'
        WHEN t1.UNIQUEID = 'ROES' THEN 'Roll Off Energy Services'
END AS ESSBASE_SUBLOB_DESC
from DEV_OCS.ODS.TP_SUBLOB t1 
join DEV_OCS.ODS.TP_LOB t2 on t1.FK_LOB = t2.pkey
 where t2.NAME in ('ROLLOFF')
) AS "v_0000017686_0000143690");
