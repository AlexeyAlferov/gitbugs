-- ***************************** SqlDBM: Snowflake ****************************
-- * Generated by SqlDBM: MART SCHEMA, v18 by lesya.rylova+standard@gmail.com *


-- ************************************** facility_location_data_MART_BMT_COMBINED_VALIDATION
CREATE VIEW facility_location_data_MART_BMT_COMBINED_VALIDATION AS 
select 
 MARKET_AREA_NM  
, count(1) TOTAL_ROWS
,sum(case when nvl(FAC_ID,'') = '' then 1 else 0 end)    		FAC_ID_NULL_CNT
,sum(case when nvl(FAC_NAME,'') = '' then 1 else 0 end)  		FAC_NAME_NULL_CNT
,sum(case when nvl(FAC_TYPE,'') = '' then 1 else 0 end)  		FAC_TYPE_NULL_CNT
,sum(case when nvl(MARKET_AREA_NM,'') = '' then 1 else 0 end) 	MARKET_AREA_NULL_CNT
,sum(case when nvl(ADDRESS_1,'') = '' then 1 else 0 end) 		ADDRESS_1_NULL_CNT
,sum(case when nvl(ADDRESS_2,'') = '' then 1 else 0 end) 		ADDRESS_2_NULL_CNT
,sum(case when nvl(CITY_NM,'') = '' then 1 else 0 end )	 		CITY_NM_NULL_CNT	
,sum(case when nvl(STATE_CD,'') = '' then 1 else 0 end)  		STATE_CD_NULL_CNT
,sum(case when nvl(ZIP_CD,'') = '' then 1 else 0 end)    		ZIP_CD_NULL_CNT
,sum(case when nvl(LATITUDE,0) = 0 then 1 else 0 end) 	 		LATITUDE_NULL_CNT
,sum(case when nvl(LONGITUDE,0) = 0 then 1 else 0 end)   		LONGITUDE_NULL_CNT
,sum(case when FAC_TYPE <>'HS' then case when nvl(TURN_TIME,0) = 0  then 1 else 0 end end) TURN_TIME_NULL_CNT
,sum(case when FAC_TYPE <>'HS' then case when nvl(MIN_TONS,0) = 0 then 1 else 0 end end) MIN_TONS_NULL_CNT
,sum(case when FAC_TYPE <>'HS' then case when nvl(MAX_TONS,0) = 0 then 1 else 0 end end)	MAX_TONS_NULL_CNT
,sum(case when FAC_TYPE <>'HS' then case when nvl(FIXED_COST,0) = 0 then 1 else 0 end end) FIXED_COST_NULL_CNT
,sum(case when nvl(WM_OWNED_FLAG,'') = '' then 1 else 0 end ) WM_OWNED_FLAG_NULL_CNT
from FACILITY_LOCATION_DATA_MART_BMT_COMBINED_VIEW
group by MARKET_AREA_NM;
