-- ***************************** SqlDBM: Snowflake ****************************
-- * Generated by SqlDBM: MART SCHEMA, v18 by lesya.rylova+standard@gmail.com *


-- ************************************** ROLLOFF_FACT
CREATE VIEW ROLLOFF_FACT as

select

LOAD_SEQ

,LAST_LOAD_FLAG

,TONS

,NBRLOADS

,COST

,GROUP_ID

,ACCOUNTNBR

,t1.LONGITUDE

,t1.LATITUDE

,t1.DEPOTFACID

,SUBLOB

,CUSTOMER_NAME

,WASTE_TYPE

,t1.OCS_DISPOSAL_NM

,t1.OCS_DISPOSAL_CD

,INTERCOMPANY

,INACTIVE

,STATE

,t2.MATCHED_LOCATIONID_TYPE as DispFacId

,WM_COLLECTION_FLAG

,LOB

,DISPOSALLEGS

,RETURNLEGS

,SERVICE_DT

,VEHICLE_ID

, GEO_COUNTY_NM

, GEO_CITY_NM

, GEO_STATE_CD

, GEO_ZIP_CD

, actl_trvl_to_dspsl_tm

, service_type_cd	

, DISPOSAL_TRIP_TYPE_cd

from

CORP_ROLLOFF_FACT t1

LEFT JOIN LOCATION_MATCHING t2 on t1.DEPOTFACID = t2.HAULING_SITE_ID and t1.OCS_DISPOSAL_CD = t2.OCS_DISPOSAL_CD

LEFT JOIN GEOCODE_RESULTS t3 on truncate(t1.longitude,6) = t3.longitude and truncate(t1.latitude,6) = t3.latitude

WHERE T1.TONS > 0;
