-- ***************************** SqlDBM: Snowflake ****************************
-- * Generated by SqlDBM: MART SCHEMA, v18 by lesya.rylova+standard@gmail.com *


-- ************************************** ENO_GREENFLOW_ALL_CAPACITY
CREATE VIEW ENO_GREENFLOW_ALL_CAPACITY AS
SELECT * FROM
(
	SELECT
		'DISPOSAL SITE CAPACITY' AS RULE_TYPE
		,EGS.ENO_ID
		,EGS.ENO_RESULTSOURCE
		,EGS.DISP_FAC_ID
		,EGS.DISP_FAC_TYPE
		,EGS.DISP_FAC_SHORT_NM
		,NULL AS WASTE_TYPE
		,EGS.VOLUME_CONSTRAINT_TYPE
		,EGS.VOLUME_TIME_UNIT
		,EGS.GOVERNING_MAX_IND
		,EGS.GOVERNING_MIN_IND
		,NULL AS FLOW_CONTROL_RULE_ID
		,NULL AS FLOW_CONTROL_SOURCE
		,NULL AS FLOW_CONTROL_SOURCE_TYPE
		,NULL AS FLOW_CONTROL_DESTINATION
		,NULL AS FLOW_CONTROL_DESTINATION_TYPE
		,NULL AS LOB
		,EGS.MIN_TONS
		,EGS.MAX_TONS
		,EGS.MIN_TONS_EXCL_3P
		,EGS.MAX_TONS_EXCL_3P
		,EGS.SOLUTION_TOTAL_TONS
		,EGS.SOLUTION_WM_TONS
		,EGS.REMAINING_CAPACITY
		,EGS.OVER_USE
		,EGS.UNDERUSE
	FROM MART.ENO_GREENFLOW_FACILITIES_CAPACITY EGS

	UNION ALL

	SELECT
		'DISPOSAL SITE WASTE TYPE' AS RULE_TYPE
		,EGF.ENO_ID
		,EGF.ENO_RESULTSOURCE
		,EGF.DISP_FAC_ID
		,EGF.DISP_FAC_TYPE
		,EGF.DISP_FAC_SHORT_NM
		,EGF.WASTE_TYPE
		,EGF.VOLUME_CONSTRAINT_TYPE
		,EGF.VOLUME_TIME_UNIT
		,EGF.GOVERNING_MAX_IND
		,EGF.GOVERNING_MIN_IND
		,NULL AS FLOW_CONTROL_RULE_ID
		,NULL AS FLOW_CONTROL_SOURCE
		,NULL AS FLOW_CONTROL_SOURCE_TYPE
		,NULL AS FLOW_CONTROL_DESTINATION
		,NULL AS FLOW_CONTROL_DESTINATION_TYPE
		,NULL AS LOB
		,EGF.MIN_TONS
		,EGF.MAX_TONS
		,EGF.MIN_TONS_EXCL_3P
		,EGF.MAX_TONS_EXCL_3P
		,EGF.SOLUTION_TOTAL_TONS
		,EGF.SOLUTION_WM_TONS
		,EGF.REMAINING_CAPACITY
		,EGF.OVER_USE
		,EGF.UNDERUSE
	FROM ENO_GREENFLOW_FACILITY_MATERIAL_CAPACITY EGF

	UNION ALL

	SELECT
		'FLOW CONTROL' AS RULE_TYPE
		,EGFC.ENO_ID
		,EGFC.ENO_RESULTSOURCE
		,NULL AS DISP_FAC_ID
		,NULL AS DISP_FAC_TYPE
		,NULL AS DISP_FAC_SHORT_NM
		,EGFC.WASTE_TYPE
		,NULL AS VOLUME_CONSTRAINT_TYPE
		,NULL AS VOLUME_TIME_UNIT
		,NULL AS GOVERNING_MAX_IND
		,NULL AS GOVERNING_MIN_IND
		,EGFC.FLOW_CONTROL_RULE_ID
		,EGFC.FLOW_CONTROL_SOURCE
		,EGFC.FLOW_CONTROL_SOURCE_TYPE
		,EGFC.FLOW_CONTROL_DESTINATION
		,EGFC.FLOW_CONTROL_DESTINATION_TYPE
		,EGFC.LOB
		,EGFC.MIN_TONS
		,EGFC.MAX_TONS
		,EGFC.MIN_TONS_EXCL_3P
		,EGFC.MAX_TONS_EXCL_3P
		,EGFC.SOLUTION_TOTAL_TONS
		,EGFC.SOLUTION_WM_TONS
		,EGFC.REMAINING_CAPACITY
		,EGFC.OVER_USE
		,EGFC.UNDERUSE
	FROM ENO_GREENFLOW_FLOW_CONTROL_CAPACITY EGFC
)
;
