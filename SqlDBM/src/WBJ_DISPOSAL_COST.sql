-- ***************************** SqlDBM: Snowflake ****************************
-- * Generated by SqlDBM: MART SCHEMA, v18 by lesya.rylova+standard@gmail.com *


-- ************************************** WBJ_DISPOSAL_COST
CREATE VIEW WBJ_DISPOSAL_COST AS

--

-- Get other waste types from WBJ if available

--

SELECT PWDC.FACILITY as FAC_ID, PWDC.DISPOSAL_COST, PWDC.WASTE_TYPE

FROM

(

  SELECT CODE AS FACILITY, ROUND(DOLLARS_TON,2)::VARCHAR(50) AS DISPOSAL_COST, 'SPW' AS WASTE_TYPE FROM STG.WBJ

  UNION

  SELECT CODE AS FACILITY, ROUND(DOLLARS_TON,2)::VARCHAR(50) AS DISPOSAL_COST, 'C&D' AS WASTE_TYPE FROM STG.WBJ 

  UNION 

  SELECT CODE AS FACILITY, ROUND(DOLLARS_TON,2)::VARCHAR(50) AS DISPOSAL_COST, 'MSW' AS WASTE_TYPE FROM STG.WBJ 

) PWDC WHERE DISPOSAL_COST > 0;
