-- ***************************** SqlDBM: Snowflake ****************************
-- * Generated by SqlDBM: MART SCHEMA, v18 by lesya.rylova+standard@gmail.com *


-- ************************************** PRE_MODEL_FACILITIES_MATERIAL
CREATE VIEW PRE_MODEL_FACILITIES_MATERIAL as

select

    t1.FAC_ID,

    t1.FAC_TYPE,

    t3.WASTE_TYPE,

    t3.ACCEPTED_FLAG,

    t3.UNIT_COST_PER_TON as UNIT_COST,

    t3.UNIT_PRICE_PER_TON as UNIT_PRICE,

    t3.UNIT_REVENUE_PER_TON as UNIT_REVENUE,

    gc.min_tons_governing_scaled as MIN_TONS,

    gc.max_tons_governing_scaled as MAX_TONS

FROM MODEL_FACILITIES t1

LEFT JOIN DISPOSAL_SITE t2 on t1.FAC_ID = T2.FAC_ID

LEFT JOIN WASTE_TYPE_ACCEPTANCE t3 on t1.FAC_ID = T3.FAC_ID

LEFT JOIN MODEL_GOVERNING_CONSTRAINTS gc ON t1.FAC_ID=gc.FAC_ID AND gc.WASTE_TYPE=t3.WASTE_TYPE AND gc.SRC='WASTE_TYPE'

WHERE t1.FAC_TYPE != 'Collection'

AND t3.ACCEPTED_FLAG IS NOT NULL

;
