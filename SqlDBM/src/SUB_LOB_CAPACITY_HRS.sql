-- ***************************** SqlDBM: Snowflake ****************************
-- * Generated by SqlDBM: MART SCHEMA, v18 by lesya.rylova+standard@gmail.com *


-- ************************************** SUB_LOB_CAPACITY_HRS
CREATE VIEW SUB_LOB_CAPACITY_HRS AS
SELECT
    REPLACE(mdl.FAC_ID,'_Depot') AS FAC_ID,
    mdl.SUBLOB,
    hs.TRUCK_CNT*10*5 AS TRUCK_CAPACITY, --TODO: Need to replace with actual duration hours
    c.TOTAL_COLLECTION_HRS,
    (TRUCK_CAPACITY - c.TOTAL_COLLECTION_HRS) AS HRS_CAP
FROM MODEL_DEPOT_LOB mdl
LEFT JOIN HAULING_SITE_CAPACITY hs
    ON REPLACE(mdl.FAC_ID,'_Depot') = hs.FAC_ID AND mdl.SUBLOB=hs.SUBLOB
LEFT JOIN SUB_LOB_MAPPED c ON REPLACE(mdl.FAC_ID,'_Depot') =c.HAULING_SITE AND mdl.SUBLOB = c.SUBLOB;
