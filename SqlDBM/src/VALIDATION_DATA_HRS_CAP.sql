-- ***************************** SqlDBM: Snowflake ****************************
-- * Generated by SqlDBM: MART SCHEMA, v18 by lesya.rylova+standard@gmail.com *


-- ************************************** VALIDATION_DATA_HRS_CAP
CREATE VIEW VALIDATION_DATA_HRS_CAP AS
SELECT
  FAC_ID
  ,SUBLOB
  ,'Hauling site ' || FAC_ID || ' in sublob ' || SUBLOB ||
        case when MIN_HRS < 0 then ' has negative MIN_HRS ' || CAST(round(MIN_HRS,2) AS STRING) else '' end ||
        case when MAX_HRS < 0 then ' has negative MAX_HRS ' || CAST(round(MAX_HRS,2) AS STRING) else '' end ||
        case when MIN_HRS > MAX_HRS then ' has MIN_HRS > MAX_HRS where MIN_HRS= ' || CAST(round(MIN_HRS,2) AS STRING) || ' and MAX_HRS = ' || CAST(round(MAX_HRS,2) AS STRING) else '' end
  AS DETAIL
  ,SUBSTR(FAC_ID,1,6) AS LH_PARM_1
  ,'COLLECTION' AS LH_PARM_2
  ,NULL AS LH_PARM_3
  ,NULL AS LH_PARM_4
  ,NULL AS LH_PARM_5  
FROM model_hrs_cap
WHERE MIN_HRS < 0.0 or MAX_HRS < 0.0 or MIN_HRS > MAX_HRS
;
