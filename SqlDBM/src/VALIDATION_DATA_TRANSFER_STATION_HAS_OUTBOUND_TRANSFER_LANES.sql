-- ***************************** SqlDBM: Snowflake ****************************
-- * Generated by SqlDBM: MART SCHEMA, v18 by lesya.rylova+standard@gmail.com *


-- ************************************** VALIDATION_DATA_TRANSFER_STATION_HAS_OUTBOUND_TRANSFER_LANES
CREATE VIEW VALIDATION_DATA_TRANSFER_STATION_HAS_OUTBOUND_TRANSFER_LANES AS
SELECT DS.FAC_ID
      ,DS.WM_OWNED_FLAG
      ,'Transfer Station ' || DS.FAC_ID || ' has no Outbound Transfer Lanes' AS DETAIL
FROM DISPOSAL_SITE DS
INNER JOIN MODEL_FACILITIES FAC on FAC.FAC_ID = DS.FAC_ID
LEFT JOIN MODEL_TRANSFER_COSTS TC ON TC.LANE_ORIGIN_FAC_ID = DS.FAC_ID
WHERE DS.FAC_TYPE='TS' AND TC.LANE_ORIGIN_FAC_ID IS NULL AND UPPER(DS.WM_OWNED_FLAG) = 'Y';
