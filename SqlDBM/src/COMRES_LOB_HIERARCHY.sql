-- ***************************** SqlDBM: Snowflake ****************************
-- * Generated by SqlDBM: MART SCHEMA, v18 by lesya.rylova+standard@gmail.com *


-- ************************************** COMRES_LOB_HIERARCHY
CREATE VIEW COMRES_LOB_HIERARCHY as (SELECT 
  "LOB", 
  "SUBLOB", 
  "SUBLOB_DESC", 
  "ESSBASE_SUBLOB_KEY", 
  "ESSBASE_SUBLOB_DESC", 
  "INFERRED_WASTETYPE" 
FROM (select t2.NAME as LOB
,t1.UNIQUEID as SUBLOB
,t1.NAME as SUBLOB_DESC
,CASE WHEN t1.UNIQUEID = 'CMRL' THEN 100
        WHEN t1.UNIQUEID = 'CMSL' THEN 110
        WHEN t1.UNIQUEID = 'CMFL' THEN 120
        WHEN t1.UNIQUEID = 'CMRY' THEN 140
		WHEN t1.UNIQUEID = 'CMFY' THEN 160
        WHEN t1.UNIQUEID = 'CMOR' THEN 175
		WHEN t1.UNIQUEID = 'RSRL' THEN 180
        WHEN t1.UNIQUEID = 'RSSL' THEN 190
		WHEN t1.UNIQUEID = 'RSFL' THEN 200
        WHEN t1.UNIQUEID = 'RSOP' THEN 210
		WHEN t1.UNIQUEID = 'RSRY' THEN 220
        WHEN t1.UNIQUEID = 'RSSY' THEN 230
		WHEN t1.UNIQUEID = 'RSFY' THEN 240
        WHEN t1.UNIQUEID = 'RSOR' THEN 255
END AS ESSBASE_SUBLOB_KEY
,CASE WHEN t1.UNIQUEID = 'CMRL' THEN 'Commercial Rearload'
        WHEN t1.UNIQUEID = 'CMSL' THEN 'Commercial Side Load'
        WHEN t1.UNIQUEID = 'CMFL' THEN 'Commercial Front Load'
        WHEN t1.UNIQUEID = 'CMRY' THEN 'Commercial Rearload Recycling'
		WHEN t1.UNIQUEID = 'CMFY' THEN 'Commercial Front Load Recyclng'
        WHEN t1.UNIQUEID = 'CMOR' THEN 'Commercial Organics'
		WHEN t1.UNIQUEID = 'RSRL' THEN 'Residential Rearload'
        WHEN t1.UNIQUEID = 'RSSL' THEN 'Residential Side Load'
		WHEN t1.UNIQUEID = 'RSFL' THEN 'Residential Front Load'
        WHEN t1.UNIQUEID = 'RSOP' THEN 'Residential One Pass'
		WHEN t1.UNIQUEID = 'RSRY' THEN 'Residential Rearload Recycling'
        WHEN t1.UNIQUEID = 'RSSY' THEN 'Residential Side Load Recyclng'
		WHEN t1.UNIQUEID = 'RSFY' THEN 'Residential Front Load Recylng'
        WHEN t1.UNIQUEID = 'RSOR' THEN 'Residential Organics'
END AS ESSBASE_SUBLOB_DESC
,t3.INFERRED_WASTETYPE
from DEV_OCS.ODS.TP_SUBLOB t1 
join  DEV_OCS.ODS.TP_LOB t2 on t1.FK_LOB = t2.pkey
left join DEV_ONEWM.MART.comres_wastetype_mapping t3
on t1.uniqueid = t3.SUBLOB where t2.NAME in ('COMMERCIAL','RESIDENTIAL')
) AS "v_0000017686_0000143797");
