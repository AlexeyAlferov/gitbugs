-- ***************************** SqlDBM: Snowflake ****************************
-- * Generated by SqlDBM: MART SCHEMA, v18 by lesya.rylova+standard@gmail.com *


-- ************************************** MODEL_RUN_PARAMETERS_FLAT
CREATE VIEW MODEL_RUN_PARAMETERS_FLAT AS

--

-- Create a flattened view of Model run parameters which unpacks the JSON

--

SELECT ENO_ID, RUN_DTM, USER_NM

, PARAMETER_JSON:"MARKET_AREA:"::VARCHAR(10) AS MARKET_AREA

, PARAMETER_JSON:"Start_Date:"::VARCHAR(10)  AS START_DATE   -- was going to make this a date but folks can enter invalid dates

, PARAMETER_JSON:"END_DATE:"::VARCHAR(10)  AS END_DATE		-- was going to make this a date but folks can enter invalid dates

, PARAMETER_JSON:"RANGE:"::VARCHAR(10) AS RANGE

, PARAMETER_JSON:"LAMBDA:"::STRING AS LAMBDA

, PARAMETER_JSON:"USERID:"::VARCHAR(256) AS USERID

, PARAMETER_JSON:"OPTIMIZE_EANDR_ONLY:"::STRING AS OPTIMIZE_EANDR_ONLY

, PARAMETER_JSON:"TMS_WEEKS:"::STRING AS TMS_WEEKS

FROM MART.model_run_parameters ;
