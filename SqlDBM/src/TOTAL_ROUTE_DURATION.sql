-- ***************************** SqlDBM: Snowflake ****************************
-- * Generated by SqlDBM: MART SCHEMA, v18 by lesya.rylova+standard@gmail.com *


-- ************************************** TOTAL_ROUTE_DURATION
CREATE VIEW TOTAL_ROUTE_DURATION as (

SELECT  -- Total duration can be consistently calculated as we always have start and end events

    HAULING_SITE,

    SUBLOB,

    RO_KEY,

    TOTAL_ROUTE_DURATION_HRS

FROM MART.TOTAL_ROUTE_DURATION_DETAILS

WHERE SERVICE_DT BETWEEN $start_date AND $end_date

AND (HAULING_SITE IN (SELECT DISTINCT REPLACE(FAC_ID,'_Depot') FROM MODEL_DEPOT_LOB))

);
