-- ***************************** SqlDBM: Snowflake ****************************
-- * Generated by SqlDBM: MART SCHEMA, v18 by lesya.rylova+standard@gmail.com *


-- ************************************** VALIDATION_AGGREGATE_MP
CREATE VIEW VALIDATION_AGGREGATE_MP AS
SELECT * FROM (
  SELECT 10 AS SORT_ORDER
        ,'SHOWSTOPPER' AS test_TYPE
        ,'FACILITIES WITH NO LAT/LONG' AS test_NAME
        ,count(*)=0 AS PASS 
        ,count(*) AS ROW_COUNT
  FROM MODEL_RUN_VALIDATION_DETAIL WHERE test_NAME = 'FACILITIES WITH NO LAT/LONG' 
  UNION ALL

  SELECT 20 AS SORT_ORDER
        ,'SHOWSTOPPER' AS test_TYPE
        ,'COLLECTION POINTS WITH NO DISPOSAL FACILITY' as test_NAME
        ,count(*)=0 AS PASS 
        ,count(*) AS ROW_COUNT
  FROM MODEL_RUN_VALIDATION_DETAIL WHERE test_NAME = 'COLLECTION POINTS WITH NO DISPOSAL FACILITY' 

  UNION ALL

  SELECT 22 AS SORT_ORDER
        ,'SHOWSTOPPER' AS test_TYPE
        ,'DISPOSAL FACILITY WITH EMPTY WASTE ACCEPTANCE' as test_NAME
        ,count(*)=0 AS PASS 
        ,count(*) AS ROW_COUNT
  FROM MODEL_RUN_VALIDATION_DETAIL WHERE test_NAME ='DISPOSAL FACILITY WITH EMPTY WASTE ACCEPTANCE' 

  UNION ALL

   SELECT 25 AS SORT_ORDER
        ,'SHOWSTOPPER' AS test_TYPE
        ,'COLLECTION POINTS DISPOSAL FACILITY NOT IN MODEL FACILITIES' as test_NAME
        ,count(*)=0 AS PASS 
        ,count(*) AS ROW_COUNT
  FROM MODEL_RUN_VALIDATION_DETAIL WHERE test_NAME ='COLLECTION POINTS DISPOSAL FACILITY NOT IN MODEL FACILITIES'

  UNION ALL

  SELECT 30 AS SORT_ORDER
        ,'SHOWSTOPPER' AS test_TYPE
        ,'HOURS CAPACITY WITH BAD MIN_HRS OR MAX_HRS' as test_NAME
        ,count(*)=0 AS PASS 
        ,count(*) AS ROW_COUNT
  FROM MODEL_RUN_VALIDATION_DETAIL WHERE test_NAME ='HOURS CAPACITY WITH BAD MIN_HRS OR MAX_HRS'

  UNION ALL

  SELECT 35 AS SORT_ORDER
        ,'SHOWSTOPPER' AS test_TYPE
        ,'TRUCK HOURS PER DAY EXCEEDS 15' as test_NAME
        ,count(*)=0 AS PASS 
        ,count(*) AS ROW_COUNT
  FROM MODEL_RUN_VALIDATION_DETAIL WHERE test_NAME ='TRUCK HOURS PER DAY EXCEEDS 15'

  UNION ALL

  SELECT 40 AS SORT_ORDER
        ,'SHOWSTOPPER' AS test_TYPE
        ,'CP USES SUBLOB THAT DOES NOT HAVE FLEET CAPACITY AT THAT HAULING STATION' AS test_NAME
        ,count(*)=0 AS PASS 
        ,count(*) AS ROW_COUNT
  FROM MODEL_RUN_VALIDATION_DETAIL WHERE test_NAME ='CP USES SUBLOB THAT DOES NOT HAVE FLEET CAPACITY AT THAT HAULING STATION'

  UNION ALL

    SELECT 60 AS SORT_ORDER
           ,'SHOWSTOPPER' AS test_TYPE
           ,'NULLS IN TRANSFER LANE AVERAGE LOAD SIZE' AS test_NAME
           ,count(*)=0 AS PASS 
           ,count(*) AS ROW_COUNT
     FROM MODEL_RUN_VALIDATION_DETAIL WHERE test_NAME ='NULLS IN TRANSFER LANE AVERAGE LOAD SIZE'

 UNION ALL

   SELECT 70 AS SORT_ORDER
          ,'SHOWSTOPPER' AS test_TYPE
          ,'NO VALID DISPOSAL LOCATION FOR FLOW-CONTROLLED COLLECTION POINT' AS test_NAME
          ,count(*)=0 AS PASS 
          ,count(*) AS ROW_COUNT
    FROM MODEL_RUN_VALIDATION_DETAIL WHERE test_NAME ='NO VALID DISPOSAL LOCATION FOR FLOW-CONTROLLED COLLECTION POINT'

 UNION ALL

      SELECT 90 AS SORT_ORDER
             ,'WARNING' AS test_TYPE
             ,'TRANSFER STATION HAS ACTIVE LANE FOR WASTE TYPE WHICH IS NOT ACCEPTED AT DESTINATION' AS test_NAME
             ,count(*)=0 AS PASS 
             ,count(*) AS ROW_COUNT
       FROM MODEL_RUN_VALIDATION_DETAIL WHERE test_NAME ='TRANSFER STATION HAS ACTIVE LANE FOR WASTE TYPE WHICH IS NOT ACCEPTED AT DESTINATION'

 UNION ALL

      SELECT 80 AS SORT_ORDER
             ,'SHOWSTOPPER' AS test_TYPE
             ,'WM TRANSFER STATION HAS NO ACTIVE OUTGOING LANE FOR WASTE TYPE' AS test_NAME
             ,count(*)=0 AS PASS 
             ,count(*) AS ROW_COUNT
       FROM MODEL_RUN_VALIDATION_DETAIL WHERE test_NAME ='WM TRANSFER STATION HAS NO ACTIVE OUTGOING LANE FOR WASTE TYPE'

  UNION ALL

  select 105 as SORT_ORDER
        ,'WARNING' AS test_TYPE
        ,'LOCATION_MATCHING TABLE HAS SUSPICIOUS RECORDS' as test_NAME
        ,count(*)=0 AS PASS 
        ,count(*) AS ROW_COUNT
  FROM MODEL_RUN_VALIDATION_DETAIL WHERE test_NAME ='LOCATION_MATCHING TABLE HAS SUSPICIOUS RECORDS'

  UNION ALL

  SELECT 110 as SORT_ORDER
        ,'WARNING' AS test_TYPE
        ,'HRS CAP TABLE HAS LEGAL HAULING SITE FACILITIES'
        ,count(*)=0 AS PASS 
        ,count(*) AS ROW_COUNT
  FROM MODEL_RUN_VALIDATION_DETAIL WHERE test_NAME ='HRS CAP TABLE HAS LEGAL HAULING SITE FACILITIES'

  UNION ALL

  SELECT 120 AS SORT_ORDER
        ,'WARNING' AS test_TYPE
        ,'TRANSFER LANES HAVE LEGAL TRANSFER-STATION AND LANDFILL FACILITIES' as test_NAME
        ,count(*)=0 AS PASS 
        ,count(*) AS ROW_COUNT
  FROM MODEL_RUN_VALIDATION_DETAIL WHERE test_NAME ='TRANSFER LANES HAVE LEGAL TRANSFER-STATION AND LANDFILL FACILITIES'

  UNION ALL

  SELECT 130 AS SORT_ORDER
        ,'WARNING' AS test_TYPE
        ,'PRE_MODEL TABLES HAD NULLS THAT WERE DEFAULTED TO OTHER VALUES' AS test_NAME
        ,count(*)=0 AS PASS 
        ,count(*) AS ROW_COUNT
  FROM MODEL_RUN_VALIDATION_DETAIL WHERE test_NAME ='PRE_MODEL TABLES HAD NULLS THAT WERE DEFAULTED TO OTHER VALUES'

  UNION ALL

  SELECT 140 AS SORT_ORDER
        ,'WARNING' AS test_TYPE
        ,'COLL. PTS HAVE A DISPOSAL/WASTE TYPE WITH UNKNOWN ACCEPTABILITY IN FACILITIES MATERIAL' AS test_NAME
        ,count(*)=0 AS PASS 
        ,count(*) AS ROW_COUNT
  FROM MODEL_RUN_VALIDATION_DETAIL WHERE test_NAME ='COLL. PTS HAVE A DISPOSAL/WASTE TYPE WITH UNKNOWN ACCEPTABILITY IN FACILITIES MATERIAL'

  UNION ALL

    SELECT 100 AS SORT_ORDER
        ,'WARNING' AS test_TYPE
        ,'CP SENT WASTE_TYPE TO FACILITY WASTE ACCEPTED FLAG=*NO*' as test_NAME
        ,count(*)=0 AS PASS 
        ,count(*) AS ROW_COUNT
  FROM MODEL_RUN_VALIDATION_DETAIL WHERE test_NAME ='CP SENT WASTE_TYPE TO FACILITY WASTE ACCEPTED FLAG=*NO*'

    UNION ALL

    SELECT 145 AS SORT_ORDER
        ,'WARNING' AS test_TYPE
        ,'TONNAGE FLOWS TO INACTIVE FACILITIES IN THE OPTIMIZED' as test_NAME
        ,count(*)=0 AS PASS 
        ,count(*) AS ROW_COUNT
  FROM MODEL_RUN_VALIDATION_DETAIL WHERE test_NAME ='TONNAGE FLOWS TO INACTIVE FACILITIES IN THE OPTIMIZED'
)
ORDER BY SORT_ORDER
;
