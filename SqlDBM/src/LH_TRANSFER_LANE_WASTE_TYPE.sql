-- ***************************** SqlDBM: Snowflake ****************************
-- * Generated by SqlDBM: MART SCHEMA, v18 by lesya.rylova+standard@gmail.com *


-- ************************************** LH_TRANSFER_LANE_WASTE_TYPE
CREATE VIEW LH_TRANSFER_LANE_WASTE_TYPE
as
select
substring(LANE_ORIGIN_FAC_ID,1,6) as LANE_ORIGIN_FAC_ID,
CASE when substring(LANE_ORIGIN_FAC_ID,8) = 'TS' then 'Transfer Station'
     when substring(LANE_ORIGIN_FAC_ID,8) = 'MRF' then 'MRF Recycling' else
                substring(LANE_ORIGIN_FAC_ID,8) end  as LANE_ORIGIN_FAC_TYPE,
WASTE_TYPE,
substring(LANE_DESTINATION_FAC_ID,1,6) as LANE_DESTINATION_FAC_ID,
FAC_NAME as LANE_DESTINATIION_FAC_NAME,
CASE when substring(LANE_DESTINATION_FAC_ID,8) = 'TS' then 'Transfer Station'
     when substring(LANE_DESTINATION_FAC_ID,8) = 'MRF' then 'MRF Recycling' else
                substring(LANE_DESTINATION_FAC_ID,8) end  as LANE_DESTINATION_FAC_TYPE, LANE_NAME,
LONG_HAUL_COST_PER_TON,
LONG_HAUL_COST_PER_LOAD ,
AVERAGE_LOAD_SIZE_TONS ,
STATUS_IND,
t1.SOURCE,
t1.LAST_UPDATED_DTM ,
t1.LAST_UPDATED_USER ,
t1.DATA_COLLCTION_ADD_DELETE_UPDATE,
t1.MIN_TONS,
t1.MAX_TONS,
t1.volume_constraint_type,
t1.volume_time_unit
from TRANSFER_LANE_WASTE_TYPE t1, DISPOSAL_SITE t2 where t1.LANE_DESTINATION_FAC_ID = t2.FAC_ID;
