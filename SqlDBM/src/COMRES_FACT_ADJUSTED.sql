-- ***************************** SqlDBM: Snowflake ****************************
-- * Generated by SqlDBM: MART SCHEMA, v18 by lesya.rylova+standard@gmail.com *


-- ************************************** COMRES_FACT_ADJUSTED
CREATE VIEW COMRES_FACT_ADJUSTED as

select

      GROUP_ID 

    , t2.MATCHED_LOCATIONID_TYPE as DispFacId

    , t1.DepotFacID

    , FAC_NM

    , t1.OCS_DISPOSAL_NM

    , t1.OCS_DISPOSAL_CD

    , INTERCOMPANY

    , INACTIVE

    , sublob

    , service_dt

    , LoadSeq

    , LoadCount

    , LAST_LOAD_FLAG 

    , Routeid

    , tons

    , COST

    , nbrloads

    , WM_Collection_Flag 

    , LOB 

    , WASTE_TYPE

    , StemLegs

    , DisposalLegs

    , ReturnLegs

    , CP_ID

    , VEHICLE_ID

from COMRES_FACT t1 LEFT JOIN LOCATION_MATCHING t2 on t1.DEPOTFACID = t2.HAULING_SITE_ID and t1.OCS_DISPOSAL_CD = t2.OCS_DISPOSAL_CD and t1.OCS_DISPOSAL_NM = t2.OCS_DISPOSAL_NM;
