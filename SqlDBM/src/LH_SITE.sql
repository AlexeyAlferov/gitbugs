-- ***************************** SqlDBM: Snowflake ****************************
-- * Generated by SqlDBM: MART SCHEMA, v18 by lesya.rylova+standard@gmail.com *


-- ************************************** LH_SITE
CREATE VIEW LH_SITE AS
--
-- NETOPT-2103:DA - remove unnecessary fields 
--
  select 
  substring(FAC_ID,1,6) as FAC_ID,
  CASE when substring(FAC_ID,8) = 'TS' then 'Transfer Station'
       when substring(FAC_ID,8) = 'MRF' then 'MRF Recycling' else
                  substring(FAC_ID,8) end  as FAC_TYPE,
  WM_OWNED_FLAG,
  FAC_NAME,
  FAC_SHORT_NM,
  case when ACTIVE_FLAG = 'Y' then 'A' when ACTIVE_FLAG = 'N' then 'I' else ACTIVE_FLAG end as ACTIVE_FLAG,  
  MARKET_AREA_NM,
  MARKET_AREA_CD,
  LATITUDE,
  LONGITUDE,
  ADDRESS_1,
  ADDRESS_2,
  CITY_NM,
  STATE_CD,
  ZIP_CD,
  COUNTRY_CD,
  COUNTY_NM,
  FIXED_COST,          
  UNIT_COST,
  SOURCE,
  LAST_UPDATED_DTM,
  LAST_UPDATED_USER,
  Monday_OPEN_AT,
  Monday_CLOSE_AT,
  Tuesday_OPEN_AT,
  Tuesday_CLOSE_AT,
  Wednesday_OPEN_AT,
  Wednesday_CLOSE_AT,
  Thursday_OPEN_AT,
  Thursday_CLOSE_AT,
  Friday_OPEN_AT,
  Friday_CLOSE_AT,
  Saturday_OPEN_AT,
  Saturday_CLOSE_AT,
  Sunday_OPEN_AT,
  Sunday_CLOSE_AT,
  GEO_CITY_NM,
  GEO_COUNTY_NM,
  GEO_STATE_CD,
  GEO_ZIP_CD
  from DISPOSAL_SITE 


  union all

  select
  FAC_ID,
  'Collection' as FAC_TYPE,
  WM_OWNED_FLAG,
  FAC_NAME,
  FAC_SHORT_NM,
  ACTIVE_FLAG,
  MARKET_AREA_NM,
  MARKET_AREA_CD,
  LATITUDE,
  LONGITUDE,
  ADDRESS_1,
  ADDRESS_2,
  CITY_NM,
  STATE_CD,
  ZIP_CD,
  COUNTRY_CD,
  COUNTY_NM, 
  NULL, 
  NULL,
  SOURCE,
  LAST_UPDATED_DTM,
  LAST_UPDATED_USER,
  Monday_OPEN_AT,
  Monday_CLOSE_AT,
  Tuesday_OPEN_AT,
  Tuesday_CLOSE_AT,
  Wednesday_OPEN_AT,
  Wednesday_CLOSE_AT,
  Thursday_OPEN_AT,
  Thursday_CLOSE_AT,
  Friday_OPEN_AT,
  Friday_CLOSE_AT,
  Saturday_OPEN_AT,
  Saturday_CLOSE_AT,
  Sunday_OPEN_AT,
  Sunday_CLOSE_AT,
  GEO_CITY_NM,
  GEO_COUNTY_NM,
  GEO_STATE_CD,
  GEO_ZIP_CD
  from HAULING_SITE;
