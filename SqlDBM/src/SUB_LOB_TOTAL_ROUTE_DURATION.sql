-- ***************************** SqlDBM: Snowflake ****************************
-- * Generated by SqlDBM: MART SCHEMA, v18 by lesya.rylova+standard@gmail.com *


-- ************************************** SUB_LOB_TOTAL_ROUTE_DURATION
CREATE VIEW SUB_LOB_TOTAL_ROUTE_DURATION AS
SELECT
    r.HAULING_SITE,
    cp.SUBLOB,
    SUM(r.TOTAL_DURATION_HRS) AS TOTAL_ROUTE_DURATION_HRS
FROM ROUTE_DURATION r
INNER JOIN MODEL_COLLECTION_POINTS cp ON TO_VARCHAR(r.RO_KEY)=cp.ROUTEID AND r.HAULING_SITE=cp.DEPOTFACID
GROUP BY r.HAULING_SITE, cp.SUBLOB;
