-- ***************************** SqlDBM: Snowflake ****************************
-- * Generated by SqlDBM: MART SCHEMA, v18 by lesya.rylova+standard@gmail.com *


-- ************************************** test_TRANSFER_LANE_WASTE_TYPE
CREATE VIEW test_TRANSFER_LANE_WASTE_TYPE as (SELECT 
  "LANE_ORIGIN_FAC_ID", 
  "WASTE_TYPE", 
  "LANE_DESTINATION_FAC_ID", 
  "LANE_NAME", 
  "LONG_HAUL_COST_PER_TON", 
  "LONG_HAUL_COST_PER_LOAD", 
  "AVERAGE_LOAD_SIZE_TONS", 
  "STATUS_IND", 
  "SOURCE", 
  "LAST_UPDATED_DTM", 
  "LAST_UPDATED_USER", 
  "DATA_COLLCTION_ADD_DELETE_UPDATE", 
  "MIN_TONS", 
  "MAX_TONS", 
  "VOLUME_CONSTRAINT_TYPE", 
  "VOLUME_TIME_UNIT" 
FROM (select
coalesce( t1.LANE_ORIGIN_FAC_ID, t2.LANE_ORIGIN_FAC_ID) as LANE_ORIGIN_FAC_ID,
coalesce( t1.WASTE_TYPE, t2.WASTE_TYPE) as WASTE_TYPE,
coalesce( t1.LANE_DESTINATION_FAC_ID, t2.LANE_DESTINATION_FAC_ID) as LANE_DESTINATION_FAC_ID,
coalesce(t1.LANE_NAME, t2.LANE_NAME) as LANE_NAME,
CASE WHEN t1.LONG_HAUL_COST_PER_TON = 0 or t1.LONG_HAUL_COST_PER_TON is null then t2.LONG_HAUL_COST else t1.LONG_HAUL_COST_PER_TON end AS LONG_HAUL_COST_PER_TON,
LONG_HAUL_COST_PER_LOAD ,
coalesce(t1.AVERAGE_LOAD_SIZE_TONS ,t2.AVERAGE_LOAD_SIZE_TONS) as AVERAGE_LOAD_SIZE_TONS,
case when t1.STATUS_IND is null then 'A' else t1.STATUS_IND end as STATUS_IND ,
case when t1.LANE_ORIGIN_FAC_ID is not null then t1.SOURCE else 'MART' end as SOURCE,
LAST_UPDATED_DTM ,
LAST_UPDATED_USER ,
DATA_COLLCTION_ADD_DELETE_UPDATE ,
MIN_TONS,
MAX_TONS,
volume_constraint_type,
volume_time_unit
from DEV_ONEWM.MART.BMT_TRANSFER_LANE_WASTE_TYPE t1 
full outer join DEV_ONEWM.MART.test_CORP_TRANSFER_LANE_WASTE_TYPE_VW t2
on  t1.LANE_ORIGIN_FAC_ID = t2.LANE_ORIGIN_FAC_ID and t1.WASTE_TYPE = T2.waste_type and
t1.LANE_DESTINATION_FAC_ID = t2.LANE_DESTINATION_FAC_ID
where nvl(DATA_COLLCTION_ADD_DELETE_UPDATE,'A') != 'D'
) AS "v_0000000307_0000041778");
