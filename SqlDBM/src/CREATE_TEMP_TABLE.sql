-- ***************************** SqlDBM: Snowflake ****************************
-- * Generated by SqlDBM: MART SCHEMA, v18 by lesya.rylova+standard@gmail.com *


-- ************************************** CREATE_TEMP_TABLE
CREATE PROCEDURE CREATE_TEMP_TABLE(IDENTIFIER VARCHAR)
RETURNS VARCHAR(16777216)
LANGUAGE JAVASCRIPT
EXECUTE AS OWNER
AS '
var sql_command = "SELECT MIN(TABLE_TYPE) FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME=''" + IDENTIFIER + "'';";
var res = snowflake.execute( {sqlText: sql_command } );
res.next();
var type = res.getColumnValue(1);
if(type==''LOCAL TEMPORARY'')
{
  var sql_command = "DROP TABLE IF EXISTS " + IDENTIFIER + ";";
  var res = snowflake.execute( {sqlText: sql_command } );
}
var sql_command = "CREATE OR REPLACE /* SqlDBM hack  TEMPORARY */ TABLE " + IDENTIFIER + " AS SELECT * FROM " + IDENTIFIER;
var res = snowflake.execute( {sqlText: sql_command } );
return 1;
';
