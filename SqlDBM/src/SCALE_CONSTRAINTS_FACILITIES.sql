-- ***************************** SqlDBM: Snowflake ****************************
-- * Generated by SqlDBM: MART SCHEMA, v18 by lesya.rylova+standard@gmail.com *


-- ************************************** SCALE_CONSTRAINTS_FACILITIES
CREATE VIEW SCALE_CONSTRAINTS_FACILITIES AS

SELECT

FAC_ID,

CASE WHEN MONDAY_OPEN_AT='Closed' THEN 0 ELSE

    COALESCE(TRY_TO_NUMBER(LEFT(Monday_CLOSE_AT,2)) -TRY_TO_NUMBER(LEFT(Monday_OPEN_AT,2)) + (TRY_TO_NUMBER(RIGHT(Monday_CLOSE_AT,2))  - TRY_TO_NUMBER(RIGHT(Monday_OPEN_AT,2)))/60,8) END AS MONDAY_OPERATING_HOURS,

CASE WHEN TUESDAY_OPEN_AT='Closed' THEN 0 ELSE

    COALESCE(TRY_TO_NUMBER(LEFT(Tuesday_CLOSE_AT,2)) -TRY_TO_NUMBER(LEFT(Tuesday_OPEN_AT,2)) + (TRY_TO_NUMBER(RIGHT(Tuesday_CLOSE_AT,2))  - TRY_TO_NUMBER(RIGHT(Tuesday_OPEN_AT,2)))/60,8) END AS TUESDAY_OPERATING_HOURS,

CASE WHEN WEDNESDAY_OPEN_AT='Closed' THEN 0 ELSE

    COALESCE(TRY_TO_NUMBER(LEFT(Wednesday_CLOSE_AT,2)) -TRY_TO_NUMBER(LEFT(Wednesday_OPEN_AT,2)) + (TRY_TO_NUMBER(RIGHT(Wednesday_CLOSE_AT,2))  - TRY_TO_NUMBER(RIGHT(Wednesday_OPEN_AT,2)))/60,8) END AS WEDNESDAY_OPERATING_HOURS,

CASE WHEN THURSDAY_OPEN_AT='Closed' THEN 0 ELSE

    COALESCE(TRY_TO_NUMBER(LEFT(Thursday_CLOSE_AT,2)) -TRY_TO_NUMBER(LEFT(Thursday_OPEN_AT,2)) + (TRY_TO_NUMBER(RIGHT(Thursday_CLOSE_AT,2))  - TRY_TO_NUMBER(RIGHT(Thursday_OPEN_AT,2)))/60,8) END AS THURSDAY_OPERATING_HOURS,

CASE WHEN FRIDAY_OPEN_AT='Closed' THEN 0 ELSE

    COALESCE(TRY_TO_NUMBER(LEFT(Friday_CLOSE_AT,2)) -TRY_TO_NUMBER(LEFT(Friday_OPEN_AT,2)) + (TRY_TO_NUMBER(RIGHT(Friday_CLOSE_AT,2)) - TRY_TO_NUMBER(RIGHT(Friday_OPEN_AT,2)))/60,8) END AS FRIDAY_OPERATING_HOURS,

CASE WHEN SATURDAY_OPEN_AT='Closed' THEN 0 ELSE

    COALESCE(TRY_TO_NUMBER(LEFT(Saturday_CLOSE_AT,2)) -TRY_TO_NUMBER(LEFT(Saturday_OPEN_AT,2)) + (TRY_TO_NUMBER(RIGHT(Saturday_CLOSE_AT,2)) - TRY_TO_NUMBER(RIGHT(Saturday_OPEN_AT,2)))/60,4) END AS SATURDAY_OPERATING_HOURS,

CASE WHEN SUNDAY_OPEN_AT='Closed' THEN 0 ELSE

    COALESCE(TRY_TO_NUMBER(LEFT(Sunday_CLOSE_AT,2)) -TRY_TO_NUMBER(LEFT(Sunday_OPEN_AT,2)) + (TRY_TO_NUMBER(RIGHT(Sunday_CLOSE_AT,2)) - TRY_TO_NUMBER(RIGHT(Sunday_OPEN_AT,2)))/60,0) END AS SUNDAY_OPERATING_HOURS,

MODEL_MONDAYS,

MODEL_TUESDAYS,

MODEL_WEDNESDAYS,

MODEL_THURSDAYS,

MODEL_FRIDAYS,

MODEL_SATURDAYS,

MODEL_SUNDAYS,

(MODEL_MONDAYS*MONDAY_OPERATING_HOURS +

 MODEL_TUESDAYS*TUESDAY_OPERATING_HOURS +

 MODEL_WEDNESDAYS*WEDNESDAY_OPERATING_HOURS +

 MODEL_THURSDAYS*THURSDAY_OPERATING_HOURS +

 MODEL_FRIDAYS*FRIDAY_OPERATING_HOURS +

 MODEL_SATURDAYS*SATURDAY_OPERATING_HOURS +

 MODEL_SUNDAYS*SUNDAY_OPERATING_HOURS) AS HOURLY_FACTOR --Number to multiply the hourly capacity rate by

FROM DISPOSAL_SITE n

LEFT JOIN SCALE_CONSTRAINTS SC;
